{"version":3,"sources":["webpack://codex-frontend/./src/components/filterFields/mapUtils/PointDistanceMap.jsx","webpack://codex-frontend/webpack/runtime/getFullHash"],"names":["lastMarker","lastCircle","PointDistanceMap","distance","gps","onChange","rest","useState","mapObject","setMapObject","mapsApi","setMapsApi","mapsApiRef","useRef","current","mapObjectRef","draw","lat","lng","setMap","console","log","safeMapsApi","safeMapObject","markerPosition","LatLng","circle","Circle","center","radius","strokeColor","strokeWeight","strokeOpacity","fillColor","fillOpacity","marker","Marker","position","useEffect","setOptions","get","parseFloat","height","width","maxWidth","maxHeight","key","googleMapsApiKey","minZoom","map","maps"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;AACA;AACA;AACA;;AAEA,IAAIA,UAAU,GAAG,IAAjB;AACA,IAAIC,UAAU,GAAG,IAAjB;AAEA;;AACe,SAASC,gBAAT,OAKZ;AAAA,2BAJDC,QAIC;AAAA,MAJDA,QAIC,8BAJU,EAIV;AAAA,MAHDC,GAGC,QAHDA,GAGC;AAAA,MAFDC,QAEC,QAFDA,QAEC;AAAA,MADEC,IACF;;AACD,kBAAkCC,+CAAQ,CAAC,IAAD,CAA1C;AAAA;AAAA,MAAOC,SAAP;AAAA,MAAkBC,YAAlB;;AACA,mBAA8BF,+CAAQ,CAAC,IAAD,CAAtC;AAAA;AAAA,MAAOG,OAAP;AAAA,MAAgBC,UAAhB;;AACA,MAAMC,UAAU,GAAGC,6CAAM,CAAC,IAAD,CAAzB;AACAD,YAAU,CAACE,OAAX,GAAqBJ,OAArB;AACA,MAAMK,YAAY,GAAGF,6CAAM,CAAC,IAAD,CAA3B;AACAE,cAAY,CAACD,OAAb,GAAuBJ,OAAvB;;AAEA,WAASM,IAAT,CAAcC,GAAd,EAAmBC,GAAnB,EAAwB;AACtB,QAAIlB,UAAJ,EAAgBA,UAAU,CAACmB,MAAX,CAAkB,IAAlB,EADM,CACmB;;AACzC,QAAIlB,UAAJ,EAAgBA,UAAU,CAACkB,MAAX,CAAkB,IAAlB,EAFM,CAEmB;;AAEzCC,WAAO,CAACC,GAAR,CAAY,MAAZ,EAAoBJ,GAApB,EAAyBC,GAAzB;AACA,QAAI,CAACR,OAAL,EAAc;AAEd,QAAMY,WAAW,GAAGZ,OAAO,IAAIE,UAAU,CAACE,OAA1C;AACA,QAAMS,aAAa,GAAGf,SAAS,IAAIO,YAAY,CAACD,OAAhD;AAEA,QAAMU,cAAc,GAAG,IAAIF,WAAW,CAACG,MAAhB,CAAuBR,GAAvB,EAA4BC,GAA5B,CAAvB;AAEA,QAAMQ,MAAM,GAAG,IAAIJ,WAAW,CAACK,MAAhB,CAAuB;AACpCC,YAAM,EAAEJ,cAD4B;AAEpCK,YAAM,EAAE,OAAO1B,QAFqB;AAGpC2B,iBAAW,EAAE,SAHuB;AAIpCC,kBAAY,EAAE,CAJsB;AAKpCC,mBAAa,EAAE,GALqB;AAMpCC,eAAS,EAAE,SANyB;AAOpCC,iBAAW,EAAE;AAPuB,KAAvB,CAAf;AAUAR,UAAM,CAACP,MAAP,CAAcI,aAAd;AAEA,QAAMY,MAAM,GAAG,IAAIb,WAAW,CAACc,MAAhB,CAAuB;AACpCC,cAAQ,EAAEb;AAD0B,KAAvB,CAAf;AAGAW,UAAM,CAAChB,MAAP,CAAcI,aAAd;AAEAvB,cAAU,GAAGmC,MAAb;AACAlC,cAAU,GAAGyB,MAAb;AACD;;AAEDY,kDAAS,CACP,YAAM;AACJ,QAAIrC,UAAJ,EAAgB;AACdA,gBAAU,CAACsC,UAAX,CAAsB;AACpBV,cAAM,EAAE,OAAO1B;AADK,OAAtB;AAGD;AACF,GAPM,EAQP,CAACA,QAAD,CARO,CAAT;AAWAmC,kDAAS,CACP,YAAM;AACJ,QAAMrB,GAAG,GAAGuB,kDAAG,CAACpC,GAAD,EAAM,GAAN,CAAf;AACA,QAAMc,GAAG,GAAGsB,kDAAG,CAACpC,GAAD,EAAM,GAAN,CAAf;AACA,QAAIa,GAAG,IAAIC,GAAX,EAAgBF,IAAI,CAACyB,UAAU,CAACxB,GAAD,CAAX,EAAkBwB,UAAU,CAACvB,GAAD,CAA5B,CAAJ;AACjB,GALM,EAMP,CAACd,GAAD,CANO,CAAT;AASA,SACE;AACE,SAAK,EAAE;AACLsC,YAAM,EAAE,GADH;AAELC,WAAK,EAAE,GAFF;AAGLC,cAAQ,EAAE,MAHL;AAILC,eAAS,EAAE;AAJN,KADT;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAQE,mDAAC,qDAAD;AACE,oBAAgB,EAAE;AAAEC,SAAG,EAAEC,gEAAgBA;AAAvB,KADpB;AAEE,iBAAa,EAAE;AACb9B,SAAG,EAAE,CADQ;AAEbC,SAAG,EAAE;AAFQ,KAFjB;AAME,eAAW,EAAE,GANf;AAOE,WAAO,EAAE;AAAE8B,aAAO,EAAE;AAAX,KAPX;AAQE,WAAO,EAAE,wBAAkB;AAAA,UAAf/B,GAAe,SAAfA,GAAe;AAAA,UAAVC,GAAU,SAAVA,GAAU;AACzBb,cAAQ,CAAC;AAAEY,WAAG,EAAHA,GAAF;AAAOC,WAAG,EAAHA;AAAP,OAAD,CAAR;AACAF,UAAI,CAACC,GAAD,EAAMC,GAAN,CAAJ;AACD,KAXH;AAYE,sCAAkC,MAZpC;AAaE,qBAAiB,EAAE,kCAAmB;AAAA,UAAhB+B,GAAgB,SAAhBA,GAAgB;AAAA,UAAXC,IAAW,SAAXA,IAAW;AACpCzC,kBAAY,CAACwC,GAAD,CAAZ;AACAtC,gBAAU,CAACuC,IAAD,CAAV;AACD;AAhBH,KAiBM5C,IAjBN;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KARF,CADF;AA8BD;;cAhGuBJ,gB;;;;;;;;;;;0BAJpBF,U;0BACAC,U;0BAGoBC,gB;;;;;;;;;;;;;;;;;;UCTxB,0C","file":"main.68cdfe48.hot-update.js","sourcesContent":["import React, { useEffect, useRef, useState } from 'react';\nimport { get } from 'lodash-es';\nimport GoogleMapReact from 'google-map-react';\nimport { googleMapsApiKey } from '../../../constants/apiKeys';\n\nlet lastMarker = null;\nlet lastCircle = null;\n\n/* component expects distance in kilometers */\nexport default function PointDistanceMap({\n  distance = 50,\n  gps,\n  onChange,\n  ...rest\n}) {\n  const [mapObject, setMapObject] = useState(null);\n  const [mapsApi, setMapsApi] = useState(null);\n  const mapsApiRef = useRef(null);\n  mapsApiRef.current = mapsApi;\n  const mapObjectRef = useRef(null);\n  mapObjectRef.current = mapsApi;\n\n  function draw(lat, lng) {\n    if (lastMarker) lastMarker.setMap(null); // remove old marker\n    if (lastCircle) lastCircle.setMap(null); // remove old circle\n\n    console.log('here', lat, lng);\n    if (!mapsApi) return;\n\n    const safeMapsApi = mapsApi || mapsApiRef.current;\n    const safeMapObject = mapObject || mapObjectRef.current;\n\n    const markerPosition = new safeMapsApi.LatLng(lat, lng);\n\n    const circle = new safeMapsApi.Circle({\n      center: markerPosition,\n      radius: 1000 * distance,\n      strokeColor: '#000000',\n      strokeWeight: 2,\n      strokeOpacity: 0.8,\n      fillColor: '#000000',\n      fillOpacity: 0.35,\n    });\n\n    circle.setMap(safeMapObject);\n\n    const marker = new safeMapsApi.Marker({\n      position: markerPosition,\n    });\n    marker.setMap(safeMapObject);\n\n    lastMarker = marker;\n    lastCircle = circle;\n  }\n\n  useEffect(\n    () => {\n      if (lastCircle) {\n        lastCircle.setOptions({\n          radius: 1000 * distance,\n        });\n      }\n    },\n    [distance],\n  );\n\n  useEffect(\n    () => {\n      const lat = get(gps, '0');\n      const lng = get(gps, '1');\n      if (lat && lng) draw(parseFloat(lat), parseFloat(lng));\n    },\n    [gps],\n  );\n\n  return (\n    <div\n      style={{\n        height: 400,\n        width: 500,\n        maxWidth: '100%',\n        maxHeight: '50vh',\n      }}\n    >\n      <GoogleMapReact\n        bootstrapURLKeys={{ key: googleMapsApiKey }}\n        defaultCenter={{\n          lat: 0,\n          lng: 0,\n        }}\n        defaultZoom={1.3}\n        options={{ minZoom: 1 }}\n        onClick={({ lat, lng }) => {\n          onChange({ lat, lng });\n          draw(lat, lng);\n        }}\n        yesIWantToUseGoogleMapApiInternals\n        onGoogleApiLoaded={({ map, maps }) => {\n          setMapObject(map);\n          setMapsApi(maps);\n        }}\n        {...rest}\n      />\n    </div>\n  );\n}\n","__webpack_require__.h = () => (\"39fdc632\")"],"sourceRoot":""}